/*! e50-charts 2015-02-19 */
angular.module("E50Charts",[]),angular.module("E50Charts").directive("e50Chart",["$timeout","E50ChartFactory","$rootScope",function(a,b,c){var d=['<div class="e50-charts">','<div class="chart"></div>',"</div>"];return{scope:{data:"=",xaxis:"=?",chart:"@",override:"=?"},template:d.join(""),link:function(a,d){var e=b.newInstance();e.setElement(d),e.setScope(a),e.setData(a.data),a.xaxis&&(e.enableXAxis(a.xaxis.columns),a.xaxis.isTimeseries&&e.enableTimeseries(a.xaxis.dateFormat,a.xaxis.tickFormat)),e.generate(a.override),a.chartTypes=e.chartTypes;var f=angular.copy(e.dataIds);f.unshift("All"),a.dataIds=f,a.dataId="All",a.executeTransform=e.executeTransform.bind(e),a.stack=e.stack.bind(e),a.unstack=e.unstack.bind(e),a.chart&&c.$broadcast(a.chart,e)}}}]),angular.module("E50Charts").factory("E50Chart",function(){function a(){this.main.append("rect").style("fill","white").attr("x",.5).attr("y",-.5).attr("width",this.width).attr("height",this.height).transition().duration(1500).attr("x",this.width).attr("width",0).remove()}function b(){this.chart=null,this.chartSelector=".chart",this.element=null,this.dataChartTypes={},this.chartElm=null,this.dataIds=[],this.chartTypes={pie:"Pie",donut:"Donut",bar:"Bar",step:"Step","area-step":"Area Step",line:"Line",area:"Area",spline:"Spline","area-spline":"Area Spline",scatter:"Scatter"},this.config={data:{columns:[],types:{}},axis:{},tooltip:{show:!0},bar:{width:{ratio:.5}},pie:{expand:!1},donut:{expand:!1},color:{pattern:["#00aeef","#666666","#eaa14b","#71ac5f"]},onresized:function(){a.call(this)},oninit:function(){a.call(this)}}}return b.prototype.setElement=function(a){this.element=a},b.prototype.setScope=function(a){this.scope=a},b.prototype.setData=function(a){var b=this;Object.keys(a).forEach(function(a){-1===b.dataIds.indexOf(a)&&b.dataIds.push(a)}),angular.forEach(a,function(a,c){var d=angular.copy(a.columns);d.unshift(c),b.config.data.columns.push(d),b.config.data.types[c]=a.type})},b.prototype.load=function(a){this.setData(a),this.chart.load(this.config.data)},b.prototype.unload=function(a){this.chart.unload(a)},b.prototype.enableXAxis=function(a){if(a){var b=a.x;b.unshift("x"),this.config.data.columns.unshift(b)}this.config.data.x="x",this.config.axis.x={type:"category"}},b.prototype.enableTimeseries=function(a,b){a&&(this.config.data.xFormat=a),this.config.axis.x={type:"timeseries",tick:{format:b||a}}},b.prototype.generate=function(a){angular.extend(this.config,a),this.chartElm=this.element.find(this.chartSelector)[0],this.config.bindto=this.chartElm,this.chart=c3.generate(this.config)},b.prototype.transform=function(a,b){return-1===this.dataIds.indexOf(b)?!1:void this.chart.transform(a,b)},b.prototype.executeTransform=function(a,b){var c="all"!==b.toLowerCase()||!b,d=c?"transform":"transformAll";return a?(("pie"===a||"donut"===a)&&(d="transformAll"),void this[d](a,b)):void alert("Please select a chart type to transform the data")},b.prototype.transformAll=function(a){this.chart.transform(a,this.dataIds)},b.prototype.show=function(a){this.chart.show(a)},b.prototype.hide=function(a){this.chart.hide(a)},b.prototype.toggle=function(a){this.chart.toggle(a)},b.prototype.focus=function(a){this.chart.focus(a)},b.prototype.defocus=function(a){this.chart.defocus(a)},b.prototype.stack=function(){this.chart.groups([this.dataIds])},b.prototype.unstack=function(){var a=[];angular.forEach(this.dataIds,function(b){a.push([b])}),this.chart.groups(a)},b}),angular.module("E50Charts").factory("E50ChartFactory",["E50Chart",function(a){return{newInstance:function(){return new a}}}]);